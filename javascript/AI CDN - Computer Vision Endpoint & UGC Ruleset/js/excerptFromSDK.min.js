function NormalizeBox(e,t,i){var r={...e};return r.height_normalized=r.height/r.source_height,r.width_normalized=r.width/r.source_width,r.y_normalized=r.y/r.source_height,r.x_normalized=r.x/r.source_width,r.height=r.height_normalized*i,r.width=r.width_normalized*t,r.scale=1,r.y=r.y_normalized*i*1,r.x=r.x_normalized*t*1,r.screenHeight=1*i,r.screenWidth=1*t,r}var colors={primary_color:"#2fa7d7",secondary_color:"#94e0ff",opacity_color:"rgba(47, 167, 215, 0.2)",blank_color:"#000000"};function DrawEyePopReticle(e){var t=document.getElementById("maincanvas"),i=t.getContext("2d"),r=NormalizeBox(e,t.width,t.height);console.log(e),console.log(t.width,t.height),console.log(r);var o=Math.min(r.height,r.width),l=Math.max(15,o/5.33333),n=r.x,s=r.y,a=r.width,c=r.height,h=0;t.dataset.xPos&&(h=t.dataset.xPos),t.dataset.yPos&&(h=t.dataset.yPos),console.log(h,0,"Canvas Origin"),n+=h,s+=0,i.beginPath(),i.rect(n,s,a,c),i.lineWidth=1,i.strokeStyle=colors.opacity_color,i.fillStyle=colors.opacity_color,i.fill(),i.stroke(),[[{x:n,y:s+l},{x:n,y:s},{x:n+l,y:s},],[{x:n,y:s+c-l},{x:n,y:s+c},{x:n+l,y:s+c},],[{x:n+a-l,y:s},{x:n+a,y:s},{x:n+a,y:s+l},],[{x:n+a,y:s+c-l},{x:n+a,y:s+c},{x:n+a-l,y:s+c},],].forEach(e=>{i.beginPath(),i.moveTo(e[0].x,e[0].y),i.lineTo(e[1].x,e[1].y),i.lineTo(e[2].x,e[2].y),i.strokeStyle=colors.primary_color,i.lineWidth=1,i.stroke()});var d=Math.max(.02*o,5);return l-=d,[[{x:n+d,y:s+d+l},{x:n+d,y:s+d},{x:n+d+l,y:s+d},],[{x:n+d,y:s-d+c-l},{x:n+d,y:s-d+c},{x:n+d+l,y:s-d+c},],[{x:n-d+a-l,y:s+d},{x:n-d+a,y:s+d},{x:n-d+a,y:s+d+l},],[{x:n-d+a,y:s-d+c-l},{x:n-d+a,y:s-d+c},{x:n-d+a-l,y:s-d+c},],].forEach(e=>{i.beginPath(),i.moveTo(e[0].x,e[0].y),i.lineTo(e[1].x,e[1].y),i.lineTo(e[2].x,e[2].y),i.strokeStyle=colors.secondary_color,i.lineWidth=1,i.stroke()}),i.font="100% Poppins",i.fillStyle="#ffffff",i.textAlign="left",i.textBaseline="top",i.fillText(toTitleCase(r.classLabel),r.x+10+d,r.y+10+d),i}function DrawEyePopPose(e,t=!0){if(e.keyPoints&&e.keyPoints[0].points){for(var i=e.keyPoints[0].points,r=document.getElementById("maincanvas"),o=r.getContext("2d"),l=[],n=0;n<i.length;n++){var s={...i[n]};s.y_normalized=s.y/e.source_height,s.x_normalized=s.x/e.source_width,s.y=s.y_normalized*r.height,s.x=s.x_normalized*r.width,o.beginPath(),o.arc(s.x,s.y,10,0,2*Math.PI,!1),o.fillStyle=colors.primary_color,o.fill(),o.strokeStyle=colors.secondary_color,o.stroke(),t&&(o.font="100% Poppins",o.fillStyle="#ffffff",o.textAlign="left",o.textBaseline="top",o.fillText(this.toTitleCase(s.classLabel),s.x+15,s.y)),o.closePath(),l[s.classLabel]=s}for(var a=[["left shoulder","right shoulder"],["left hip","right hip"],["left shoulder","left elbow"],["left elbow","left wrist"],["left shoulder","right hip"],["left hip","left knee"],["left knee","left ankle"],["right shoulder","right elbow"],["right elbow","right wrist"],["right shoulder","left hip"],["right hip","right knee"],["right knee","right ankle"],],n=0;n<a.length;n++){var c=l[a[n][0]],h=l[a[n][1]];c&&c.x&&h&&h.x&&(o.beginPath(),o.lineWidth=3,o.strokeStyle=colors.primary_color,o.fillStyle=colors.primary_color,o.moveTo(c.x,c.y),o.lineTo(h.x,h.y),o.stroke(),o.closePath())}}}function toTitleCase(e){return e?e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}):""}class Rules{static FindObjects(e,t){return t.filter(t=>t.classLabel===e)}static Biggest(e,t){return(t=Rules.FindObjects(e,t)).reduce((e,t)=>{let i=e.width*e.height,r=t.width*t.height;return r>i?t:e},t[0]||{})}static Area(e,t,i){var r=e.width*e.height/(t*i);return console.log(r),r}static Between(e,t,i){return e>=t&&e<=i}static Amount(e,t){return t.filter(t=>t.classLabel===e).length}static PosePoint(e,t){if(!t||!t.keyPoints)return!1;let i=t.keyPoints[0].points.find(t=>t.classLabel===e);return!!i}static Emotion(e,t){if(!t||!t.objects)return!1;let i=t.objects.find(e=>"face"===e.classLabel);if(!i)return!1;let r=i.classes.find(t=>t.classLabel===e);return!!r}static Gender(e,t){if(!t||!t.objects)return!1;let i=t.objects.find(e=>"face"===e.classLabel);if(!i)return!1;let r=i.classes.find(t=>t.classLabel===e);return!!r}static Position(e,t,i){if(console.log(e,i),!e||!i)return!1;switch(t){case"above":return e.y<i.y;case"below":return e.y>i.y;case"left":return e.x<i.x;case"right":return e.x>i.x;default:return console.error("Unknown direction:",t),!1}}static Check(e,t,i){var r=[];return t.forEach((t,o)=>{if(console.log(t),Array.isArray(t.condition)){var l=i[o];return(l||(l={count:0,rule_index:0,length:t.length}),t.condition[l.rule_index](e))?(l.rule_index++,console.log(l),l.rule_index==l.length&&(console.log("Fired:",t.description),r.push([!0,t.description]),l.rule_index=0,l.count++),r):(console.log("NOT fired:",t.description),r.push([!1,t.description]),r)}t.condition(e)?(console.log("Fired:",t.description),r.push([!0,t.description])):(console.log("NOT fired:",t.description),r.push([!1,t.description]))}),r}}